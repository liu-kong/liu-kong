# .github/workflows/snake.yml
name: Contribution Snake Generator
on:
  schedule:
    - cron: "0 0 * * *"  # æ¯å¤©UTCæ—¶é—´0ç‚¹è‡ªåŠ¨è¿è¡Œ
  workflow_dispatch:     # å…è®¸æ‰‹åŠ¨è§¦å‘

permissions:
  contents: write       # å¿…é¡»çš„å†™æƒé™

jobs:
  generate-snake:
    runs-on: ubuntu-latest
    steps:
      # Step 1: æ£€å‡ºä»£ç åº“ï¼ˆä½¿ç”¨é»˜è®¤è·¯å¾„ï¼‰
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # è·å–å®Œæ•´æäº¤å†å²
          persist-credentials: false

      # Step 2: ç”Ÿæˆè´ªåƒè›‡å›¾åƒ
      - name: Generate contribution snake
        uses: Platane/snk@v3
        id: snake
        with:
          github_user_name: ${{ github.repository_owner }}
          outputs: |
            generated/snake.svg
            generated/snake-dark.svg?palette=github-dark

      # Step 3: æäº¤å˜æ›´ï¼ˆä½¿ç”¨éªŒè¯è¿‡çš„æ¨é€æ–¹æ¡ˆï¼‰
      - name: Deploy to GitHub
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: main
          folder: generated
          clean: true
          clean-exclude: |
            !.gitkeep
          commit-message: "ğŸ Auto-update contribution snake [skip ci]"
